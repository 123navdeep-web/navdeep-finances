<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Navdeep's Finances</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet"/>
  <style>
    :root {
      --glass: rgba(255,255,255,0.055);
      --glass-border: rgba(255,255,255,0.12);
      --text: rgba(255,255,255,0.92);
      --text-2: rgba(255,255,255,0.55);
      --text-3: rgba(255,255,255,0.28);
      --radius: 20px;
      --radius-sm: 12px;
      --blur: blur(32px) saturate(180%);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    input, select, button, textarea { font-family: inherit; }
    ::-webkit-scrollbar { width: 3px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,.15); border-radius: 2px; }
    .bg {
      min-height: 100vh;
      background:
        radial-gradient(ellipse 80% 60% at 20% 10%, rgba(120,40,220,.55) 0%, transparent 60%),
        radial-gradient(ellipse 70% 50% at 80% 80%, rgba(30,80,220,.45) 0%, transparent 60%),
        radial-gradient(ellipse 50% 40% at 60% 30%, rgba(180,60,255,.25) 0%, transparent 55%),
        linear-gradient(160deg, #0d0025 0%, #060018 40%, #020012 100%);
      font-family: 'Nunito', -apple-system, sans-serif;
      color: var(--text);
      position: relative;
      overflow-x: hidden;
    }
    .bg::before {
      content: '';
      position: fixed; top: -20%; left: -10%; width: 60vw; height: 60vw;
      background: radial-gradient(circle, rgba(130,50,255,.18) 0%, transparent 70%);
      border-radius: 50%; pointer-events: none; z-index: 0;
      animation: drift1 18s ease-in-out infinite alternate;
    }
    .bg::after {
      content: '';
      position: fixed; bottom: -15%; right: -5%; width: 50vw; height: 50vw;
      background: radial-gradient(circle, rgba(40,100,255,.15) 0%, transparent 70%);
      border-radius: 50%; pointer-events: none; z-index: 0;
      animation: drift2 22s ease-in-out infinite alternate;
    }
    @keyframes drift1 { from { transform: translate(0,0) scale(1); } to { transform: translate(4%,3%) scale(1.08); } }
    @keyframes drift2 { from { transform: translate(0,0) scale(1); } to { transform: translate(-3%,-4%) scale(1.1); } }
    .content { position: relative; z-index: 1; }
    .glass {
      background: var(--glass);
      backdrop-filter: var(--blur);
      -webkit-backdrop-filter: var(--blur);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      position: relative; overflow: hidden;
    }
    .glass::before {
      content: ''; position: absolute; inset: 0; border-radius: inherit; pointer-events: none;
      background: linear-gradient(135deg, rgba(255,255,255,.08) 0%, transparent 50%, rgba(255,255,255,.02) 100%);
    }
    .tabs-wrap {
      background: rgba(255,255,255,0.06); backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,.1); border-radius: 14px;
      padding: 4px; display: inline-flex; gap: 2px;
    }
    .tab {
      background: none; border: none; cursor: pointer;
      padding: 8px 22px; border-radius: 10px; font-size: 13px; font-weight: 600;
      transition: all .2s; color: var(--text-2); letter-spacing: .2px;
    }
    .tab.on { background: rgba(255,255,255,.14); color: var(--text); box-shadow: 0 1px 8px rgba(0,0,0,.3), inset 0 1px 0 rgba(255,255,255,.15); }
    .tab:hover:not(.on) { color: var(--text); background: rgba(255,255,255,.05); }
    .btn-accent {
      background: linear-gradient(135deg, rgba(180,100,255,.8) 0%, rgba(100,140,255,.8) 100%);
      color: white; border: 1px solid rgba(255,255,255,.2); border-radius: var(--radius-sm);
      padding: 10px 22px; font-size: 13px; font-weight: 700; cursor: pointer;
      box-shadow: 0 4px 20px rgba(150,80,255,.4), inset 0 1px 0 rgba(255,255,255,.25); transition: all .2s;
    }
    .btn-accent:hover { transform: translateY(-1px); box-shadow: 0 8px 30px rgba(150,80,255,.55), inset 0 1px 0 rgba(255,255,255,.3); }
    .btn-accent:disabled { opacity: .45; cursor: not-allowed; transform: none; }
    .btn-glass {
      background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,.13);
      color: var(--text-2); border-radius: var(--radius-sm);
      padding: 8px 14px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all .2s;
    }
    .btn-glass:hover { background: rgba(255,255,255,.13); color: var(--text); border-color: rgba(255,255,255,.22); }
    .btn-ghost {
      background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,.08);
      color: var(--text-3); border-radius: 8px; padding: 5px 10px;
      font-size: 14px; cursor: pointer; transition: all .2s; line-height: 1;
    }
    .btn-ghost:hover { background: rgba(255,80,80,.15); border-color: rgba(255,80,80,.3); color: #ff8080; }
    .btn-green {
      background: linear-gradient(135deg, rgba(30,200,120,.7), rgba(20,160,100,.7));
      border: 1px solid rgba(52,235,168,.3); color: white; border-radius: var(--radius-sm);
      padding: 10px 22px; font-size: 13px; font-weight: 700; cursor: pointer; transition: all .2s;
      box-shadow: 0 4px 20px rgba(30,200,120,.3);
    }
    .btn-green:hover { transform: translateY(-1px); box-shadow: 0 8px 30px rgba(30,200,120,.4); }
    .btn-green:disabled { opacity: .4; cursor: not-allowed; transform: none; }
    .ifield {
      background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,.12);
      border-radius: var(--radius-sm); padding: 11px 14px;
      color: var(--text); font-size: 13px; width: 100%; outline: none;
      transition: all .2s; font-weight: 500;
    }
    .ifield::placeholder { color: var(--text-3); }
    .ifield:focus { border-color: rgba(180,120,255,.6); background: rgba(255,255,255,.09); box-shadow: 0 0 0 3px rgba(160,100,255,.15); }
    .ifield option { background: #1a0a35; color: white; }
    .pb { height: 6px; background: rgba(255,255,255,.08); border-radius: 99px; overflow: hidden; }
    .pf { height: 100%; border-radius: 99px; transition: width .6s cubic-bezier(.4,0,.2,1); }
    .lbl { font-size: 10px; color: var(--text-3); text-transform: uppercase; letter-spacing: 1.2px; font-weight: 700; margin-bottom: 6px; }
    .sl  { font-size: 10px; color: var(--text-3); text-transform: uppercase; letter-spacing: 1.2px; font-weight: 700; margin-bottom: 6px; }
    .sv  { font-family: 'JetBrains Mono', monospace; font-size: 26px; font-weight: 500; letter-spacing: -.5px; }
    .row { display: flex; align-items: center; gap: 12px; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,.06); }
    .row:last-child { border-bottom: none; }
    .dot { width: 9px; height: 9px; border-radius: 50%; flex-shrink: 0; }
    .stat-glow {
      position: absolute; top: -40%; left: -20%; width: 140%; height: 140%;
      background: radial-gradient(ellipse 60% 40% at 50% 0%, rgba(255,255,255,.06) 0%, transparent 70%);
      pointer-events: none;
    }
    .ov {
      position: fixed; inset: 0; z-index: 100; padding: 20px;
      display: flex; align-items: center; justify-content: center;
      background: rgba(5,0,20,.65); backdrop-filter: blur(16px);
    }
    .mod {
      background: rgba(20,8,45,.9); backdrop-filter: blur(40px) saturate(200%);
      border: 1px solid rgba(255,255,255,.18); border-radius: 24px;
      padding: 32px; width: 100%; max-width: 500px;
      position: relative; overflow: hidden;
      box-shadow: 0 32px 80px rgba(0,0,0,.7), inset 0 1px 0 rgba(255,255,255,.15);
    }
    .mod::before {
      content: ''; position: absolute; inset: 0; border-radius: inherit; pointer-events: none;
      background: linear-gradient(135deg, rgba(255,255,255,.07) 0%, transparent 50%);
    }
    .mod-wide { max-width: 700px; }
    .toast {
      position: fixed; bottom: 28px; left: 50%; transform: translateX(-50%);
      background: rgba(255,255,255,.1); backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,.2); color: var(--text);
      padding: 12px 24px; border-radius: 99px; font-size: 13px; font-weight: 600;
      z-index: 200; white-space: nowrap; box-shadow: 0 8px 32px rgba(0,0,0,.4);
      animation: toastIn .3s cubic-bezier(.34,1.56,.64,1);
    }
    @keyframes toastIn { from { opacity:0; transform: translateX(-50%) translateY(12px); } to { opacity:1; transform: translateX(-50%) translateY(0); } }
    .mpill { padding: 5px 13px; border-radius: 99px; font-size: 11px; font-weight: 700; border: 1px solid; cursor: pointer; transition: all .2s; }
    .banner { background: rgba(255,180,50,.07); border: 1px solid rgba(255,180,50,.2); border-radius: var(--radius-sm); padding: 10px 16px; font-size: 12px; color: rgba(255,200,80,.85); font-weight: 500; }
    .upload-zone {
      border: 2px dashed rgba(180,120,255,.35); border-radius: var(--radius);
      padding: 40px 24px; text-align: center; cursor: pointer; transition: all .25s;
      background: rgba(150,80,255,.04); position: relative;
    }
    .upload-zone:hover, .upload-zone.drag { border-color: rgba(180,120,255,.7); background: rgba(150,80,255,.1); }
    .upload-zone input { position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
    .parse-row { display: flex; align-items: center; gap: 10px; padding: 10px 14px; border-radius: 12px; background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.07); margin-bottom: 8px; }
    .parse-row.excluded { opacity: .35; }
    .spin { width: 36px; height: 36px; border: 3px solid rgba(180,120,255,.2); border-top-color: #c084fc; border-radius: 50%; animation: spin .8s linear infinite; margin: 0 auto 16px; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .chk { width: 18px; height: 18px; border-radius: 5px; border: 1.5px solid rgba(255,255,255,.2); background: rgba(255,255,255,.06); cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; transition: all .15s; }
    .chk.on { background: rgba(130,80,255,.6); border-color: rgba(180,120,255,.8); }
    .grad-title { font-weight: 700; background: linear-gradient(135deg,#fff,rgba(200,160,255,.9)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useRef } = React;
    const MONTHLY_BUDGET = { Rent:2500, Groceries:600, Car:500, Utilities:150, Phone:80, Insurance:200, Misc:400 };
    const TOTAL_BUDGET   = Object.values(MONTHLY_BUDGET).reduce((a,b)=>a+b,0);
    const SAVINGS_TARGET = 100000;
    const MONTHLY_SAVINGS_GOAL = 7500;
    const CATEGORIES = Object.keys(MONTHLY_BUDGET);
    const COLORS = { Rent:"#ff6b6b", Groceries:"#ff9f43", Car:"#ffd32a", Utilities:"#0be881", Phone:"#00d2d3", Insurance:"#a29bfe", Misc:"#fd79a8" };
    const GLOWS  = { Rent:"rgba(255,107,107,.35)", Groceries:"rgba(255,159,67,.35)", Car:"rgba(255,211,42,.35)", Utilities:"rgba(11,232,129,.35)", Phone:"rgba(0,210,211,.35)", Insurance:"rgba(162,155,254,.35)", Misc:"rgba(253,121,168,.35)" };
    const fmt     = n => "$" + Number(n).toLocaleString("en-US", {minimumFractionDigits:0, maximumFractionDigits:0});
    const mkDate  = () => new Date().toISOString().split("T")[0];
    const mkMonth = () => { const d = new Date(); return d.getFullYear() + "-" + String(d.getMonth()+1).padStart(2,"0"); };
    const mkLabel = k => { const [y,m] = k.split("-"); return new Date(y,m-1).toLocaleString("default",{month:"long",year:"numeric"}); };

    async function parseStatementWithAI(file) {
      const base64 = await new Promise((res,rej) => {
        const r = new FileReader();
        r.onload = () => res(r.result.split(",")[1]);
        r.onerror = () => rej(new Error("Read failed"));
        r.readAsDataURL(file);
      });
      const isPDF = file.type === "application/pdf";
      const isImg = file.type.startsWith("image/");
      if (!isPDF && !isImg) throw new Error("Please upload a PDF or image file.");
      const contentBlock = isPDF
        ? { type:"document", source:{ type:"base64", media_type:"application/pdf", data:base64 } }
        : { type:"image",    source:{ type:"base64", media_type:file.type, data:base64 } };
      const prompt = `Parse this bank or credit card statement. Extract ALL expense transactions (debits/charges). Skip credits, refunds, card payments. Return ONLY a JSON array. Each item: {date:"YYYY-MM-DD", description:"merchant name max 40 chars", amount:positive_number, category:"Rent|Groceries|Car|Utilities|Phone|Insurance|Misc"}. Category guide: Rent=rent/housing, Groceries=supermarket/food store/H-Mart/ShopRite, Car=gas/parking/toll/uber/lyft, Utilities=electric/gas utility/water/internet/PSE&G, Phone=wireless/phone bill/T-Mobile/Verizon, Insurance=insurance/medical/copay, Misc=everything else. Return [] if none found. No markdown, no explanation, ONLY the JSON array.`;
      const resp = await fetch("https://api.anthropic.com/v1/messages", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          model: "claude-sonnet-4-20250514",
          max_tokens: 4096,
          messages: [{ role:"user", content:[contentBlock, {type:"text",text:prompt}] }]
        })
      });
      if (!resp.ok) throw new Error("API error " + resp.status);
      const data = await resp.json();
      const text = (data.content||[]).map(b=>b.text||"").join("").replace(/```json|```/g,"").trim();
      const parsed = JSON.parse(text);
      if (!Array.isArray(parsed)) throw new Error("Unexpected response");
      if (parsed.length === 0) throw new Error("No expense transactions found in this file.");
      return parsed.map((item,i) => ({
        ...item, id: Date.now()+i, include: true,
        amount: parseFloat(item.amount)||0,
        category: CATEGORIES.includes(item.category) ? item.category : "Misc"
      }));
    }

    function GradTitle({ children, size=20 }) {
      return <div className="grad-title" style={{fontSize:size}}>{children}</div>;
    }

    function ReviewTable({ items, onToggle, onCat }) {
      return (
        <div>
          <div style={{display:"flex",gap:10,padding:"0 14px 8px",borderBottom:"1px solid rgba(255,255,255,.07)",marginBottom:8}}>
            <div style={{width:18}}/>
            <div style={{flex:"0 0 90px",fontSize:10,color:"var(--text-3)",fontWeight:700,textTransform:"uppercase",letterSpacing:1}}>Date</div>
            <div style={{flex:1,fontSize:10,color:"var(--text-3)",fontWeight:700,textTransform:"uppercase",letterSpacing:1}}>Description</div>
            <div style={{flex:"0 0 110px",fontSize:10,color:"var(--text-3)",fontWeight:700,textTransform:"uppercase",letterSpacing:1}}>Category</div>
            <div style={{flex:"0 0 70px",fontSize:10,color:"var(--text-3)",fontWeight:700,textTransform:"uppercase",letterSpacing:1,textAlign:"right"}}>Amount</div>
          </div>
          <div style={{maxHeight:"320px",overflowY:"auto",paddingRight:4}}>
            {items.map(item => (
              <div key={item.id} className={"parse-row" + (!item.include?" excluded":"")}>
                <div className={"chk"+(item.include?" on":"")} onClick={()=>onToggle(item.id)}>
                  {item.include && <span style={{color:"white",fontSize:11,fontWeight:700}}>&#10003;</span>}
                </div>
                <div style={{flex:"0 0 90px",fontSize:12,color:"var(--text-2)",fontFamily:"'JetBrains Mono',monospace",fontWeight:500}}>{item.date}</div>
                <div style={{flex:1,fontSize:12,color:"var(--text)",fontWeight:600,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{item.description}</div>
                <select style={{flex:"0 0 110px",background:"rgba(255,255,255,.08)",border:"1px solid rgba(255,255,255,.12)",borderRadius:8,color:"var(--text)",fontSize:11,padding:"4px 8px",outline:"none",fontWeight:600,cursor:"pointer"}}
                  value={item.category} onChange={e=>onCat(item.id,e.target.value)}>
                  {CATEGORIES.map(c=><option key={c} style={{background:"#1a0a35"}}>{c}</option>)}
                </select>
                <div style={{flex:"0 0 70px",textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontSize:13,fontWeight:600,color:item.include?"var(--text)":"var(--text-3)"}}>{fmt(item.amount)}</div>
              </div>
            ))}
          </div>
        </div>
      );
    }

    function App() {
      const [expenses,    setExpenses]    = useState([]);
      const [savings,     setSavings]     = useState([]);
      const [eDate,       setEDate]       = useState(mkDate());
      const [eCat,        setECat]        = useState("Groceries");
      const [eAmt,        setEAmt]        = useState("");
      const [eNote,       setENote]       = useState("");
      const [sDate,       setSDate]       = useState(mkDate());
      const [sAmt,        setSAmt]        = useState("");
      const [sNote,       setSNote]       = useState("");
      const [activeMonth, setActiveMonth] = useState(mkMonth());
      const [tab,         setTab]         = useState("dashboard");
      const [showSavings, setShowSavings] = useState(false);
      const [showImport,  setShowImport]  = useState(false);
      const [importText,  setImportText]  = useState("");
      const [importError, setImportError] = useState("");
      const [toast,       setToast]       = useState("");
      const [showStatement, setShowStatement] = useState(false);
      const [parseStage,    setParseStage]    = useState("upload");
      const [parsedItems,   setParsedItems]   = useState([]);
      const [parseError,    setParseError]    = useState("");
      const [dragOver,      setDragOver]      = useState(false);
      const fileRef = useRef();
      const stmtRef = useRef();
      const showToast = msg => { setToast(msg); setTimeout(()=>setToast(""),2800); };

      const addExpense = () => {
        const amt = parseFloat(eAmt);
        if (!eAmt || amt <= 0) return;
        setExpenses(p=>[{id:Date.now(),date:eDate,category:eCat,amount:amt,note:eNote},...p]);
        setEAmt(""); setENote("");
        showToast("Expense added");
      };
      const addSavings = () => {
        const amt = parseFloat(sAmt);
        if (!sAmt || amt <= 0) return;
        setSavings(p=>[{id:Date.now(),date:sDate,amount:amt,note:sNote},...p]);
        setSAmt(""); setSNote("");
        setShowSavings(false);
        showToast("Savings logged");
      };
      const exportData = () => {
        const blob = new Blob([JSON.stringify({expenses,savings,exportedAt:new Date().toISOString(),version:1},null,2)],{type:"application/json"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a"); a.href=url; a.download="navdeep-finances-"+mkDate()+".json"; a.click();
        URL.revokeObjectURL(url);
        showToast("File saved!");
      };
      const handleDataFile = e => {
        const file = e.target.files[0]; if (!file) return;
        const reader = new FileReader();
        reader.onload = ev => { setImportText(ev.target.result); setShowImport(true); setImportError(""); };
        reader.readAsText(file); e.target.value="";
      };
      const doImport = () => {
        try {
          const d = JSON.parse(importText);
          if (!Array.isArray(d.expenses)||!Array.isArray(d.savings)) throw new Error();
          setExpenses(d.expenses); setSavings(d.savings);
          setShowImport(false); setImportText("");
          showToast("Loaded " + d.expenses.length + " expenses & " + d.savings.length + " savings");
        } catch { setImportError("Invalid file. Use the exported JSON from this tracker."); }
      };
      const handleStatementFile = async file => {
        setParseStage("parsing"); setParseError("");
        try {
          const items = await parseStatementWithAI(file);
          setParsedItems(items);
          setParseStage("review");
        } catch(err) {
          setParseError(err.message||"Failed to parse statement.");
          setParseStage("upload");
        }
      };
      const commitParsed = () => {
        const toAdd = parsedItems.filter(i=>i.include&&i.amount>0).map(i=>({id:Date.now()+Math.random(),date:i.date,category:i.category,amount:i.amount,note:i.description}));
        setExpenses(p=>[...toAdd,...p]);
        setShowStatement(false);
        showToast(toAdd.length + " expenses imported");
      };
      const toggleItem = id => setParsedItems(p=>p.map(i=>i.id===id?{...i,include:!i.include}:i));
      const changeCat  = (id,cat) => setParsedItems(p=>p.map(i=>i.id===id?{...i,category:cat}:i));
      const inclCount  = parsedItems.filter(i=>i.include).length;
      const inclTotal  = parsedItems.filter(i=>i.include).reduce((a,i)=>a+i.amount,0);
      const monthExpenses = expenses.filter(e=>e.date.startsWith(activeMonth));
      const totalSaved    = savings.reduce((a,s)=>a+s.amount,0);
      const spentByCat    = CATEGORIES.reduce((acc,cat)=>{ acc[cat]=monthExpenses.filter(e=>e.category===cat).reduce((a,e)=>a+e.amount,0); return acc; },{});
      const totalSpent    = Object.values(spentByCat).reduce((a,b)=>a+b,0);
      const monthlyLeft   = TOTAL_BUDGET - totalSpent;
      const savingsPct    = Math.min((totalSaved/SAVINGS_TARGET)*100,100);
      const months        = [...new Set(expenses.map(e=>e.date.slice(0,7)))].sort().reverse();
      if (!months.includes(mkMonth())) months.unshift(mkMonth());
      const timePct = (()=>{ const s=new Date("2026-01-15"),e=new Date("2027-02-01"),n=new Date(); return Math.min(Math.max(0,(n-s)/(e-s))*100,100); })();

      const monthPicker = (
        <div style={{display:"flex",gap:6,flexWrap:"wrap"}}>
          {months.slice(0,8).map(m=>(
            <button key={m} className="mpill" onClick={()=>setActiveMonth(m)} style={{background:activeMonth===m?"rgba(180,120,255,.25)":"rgba(255,255,255,.05)",borderColor:activeMonth===m?"rgba(180,120,255,.5)":"rgba(255,255,255,.1)",color:activeMonth===m?"#d4a8ff":"rgba(255,255,255,.4)",boxShadow:activeMonth===m?"0 0 12px rgba(160,80,255,.25)":"none"}}>{mkLabel(m).split(" ")[0].slice(0,3)} '{m.slice(2,4)}</button>
          ))}
        </div>
      );
      const expenseForm = (
        <div style={{display:"grid",gridTemplateColumns:"130px 150px 130px 1fr auto",gap:10,alignItems:"end"}}>
          <div><div className="lbl">Date</div><input className="ifield" type="date" value={eDate} onChange={e=>setEDate(e.target.value)}/></div>
          <div><div className="lbl">Category</div><select className="ifield" value={eCat} onChange={e=>setECat(e.target.value)}>{CATEGORIES.map(c=><option key={c}>{c}</option>)}</select></div>
          <div><div className="lbl">Amount ($)</div><input className="ifield" type="number" min="0" step="0.01" placeholder="0.00" value={eAmt} onChange={e=>setEAmt(e.target.value)}/></div>
          <div><div className="lbl">Note</div><input className="ifield" type="text" placeholder="Optional..." value={eNote} onChange={e=>setENote(e.target.value)}/></div>
          <button className="btn-accent" onClick={addExpense} style={{alignSelf:"end",whiteSpace:"nowrap"}}>Add</button>
        </div>
      );

      return (
        <div className="bg">
          <div className="content">
            {toast && <div className="toast">{toast}</div>}
            <div style={{padding:"28px 28px 0",marginBottom:28}}>
              <div style={{maxWidth:1000,margin:"0 auto"}}>
                <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:20,flexWrap:"wrap",gap:12}}>
                  <div>
                    <div style={{fontSize:11,color:"rgba(180,130,255,.7)",letterSpacing:3,textTransform:"uppercase",fontWeight:700,marginBottom:6}}>GEP · Clark, NJ</div>
                    <GradTitle size={26}>Navdeep's Finances</GradTitle>
                  </div>
                  <div style={{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"}}>
                    <input ref={fileRef} type="file" accept=".json" style={{display:"none"}} onChange={handleDataFile}/>
                    <button className="btn-glass" onClick={()=>fileRef.current.click()}>&#128194; Load</button>
                    <button className="btn-glass" onClick={exportData} style={{borderColor:"rgba(52,235,168,.25)",color:"rgba(52,235,168,.8)"}}>&#128190; Save</button>
                    <button className="btn-glass" onClick={()=>{setParseStage("upload");setParsedItems([]);setParseError("");setShowStatement(true);}} style={{borderColor:"rgba(180,120,255,.35)",color:"rgba(200,160,255,.9)"}}>&#127974; Statement</button>
                    <button className="btn-accent" onClick={()=>setShowSavings(true)}>+ Savings</button>
                  </div>
                </div>
                <div className="banner" style={{marginBottom:20}}>&#9888; Data lives in this session only — click <strong>&#128190; Save</strong> before closing, <strong>&#128194; Load</strong> next time to restore.</div>
                <div className="tabs-wrap">
                  {["dashboard","expenses","savings"].map(t=>(
                    <button key={t} className={"tab"+(tab===t?" on":"")} onClick={()=>setTab(t)}>{t[0].toUpperCase()+t.slice(1)}</button>
                  ))}
                </div>
              </div>
            </div>

            <div style={{maxWidth:1000,margin:"0 auto",padding:"0 28px 60px"}}>
              {tab==="dashboard" && (
                <div>
                  <div style={{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(180px,1fr))",gap:14,marginBottom:18}}>
                    {[
                      {label:"Total Saved",value:fmt(totalSaved),sub:"of "+fmt(SAVINGS_TARGET)+" goal",accent:"#c084fc"},
                      {label:"Month Spent",value:fmt(totalSpent),sub:"of "+fmt(TOTAL_BUDGET)+" budget",accent:totalSpent>TOTAL_BUDGET?"#ff6b8a":"rgba(255,255,255,.7)"},
                      {label:"Remaining",value:fmt(Math.abs(monthlyLeft)),sub:monthlyLeft<0?"over budget":"left to spend",accent:monthlyLeft<0?"#ff6b8a":"#34eba8"},
                      {label:"Monthly Goal",value:fmt(MONTHLY_SAVINGS_GOAL),sub:"to reach $100k by Feb '27",accent:"#ffb347"},
                    ].map(s=>(
                      <div key={s.label} className="glass" style={{padding:"20px 22px"}}>
                        <div className="stat-glow"/>
                        <div className="sl">{s.label}</div>
                        <div className="sv" style={{color:s.accent,marginBottom:4}}>{s.value}</div>
                        <div style={{fontSize:11,color:"var(--text-3)",fontWeight:500}}>{s.sub}</div>
                      </div>
                    ))}
                  </div>
                  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:18}}>
                    {[
                      {label:"$100k Savings Goal",pct:savingsPct,g:"linear-gradient(90deg,#9333ea,#c084fc)",sub:fmt(totalSaved)+" saved · "+fmt(SAVINGS_TARGET-totalSaved)+" to go",tc:"#c084fc"},
                      {label:"Journey to Feb 2027",pct:timePct,g:"linear-gradient(90deg,#ea8c33,#fbbf24)",sub:"Jan 2026 start · Feb 2027 target",tc:"#fbbf24"},
                    ].map(b=>(
                      <div key={b.label} className="glass" style={{padding:"20px 22px"}}>
                        <div className="stat-glow"/>
                        <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}>
                          <div className="sl">{b.label}</div>
                          <div style={{fontSize:13,color:b.tc,fontFamily:"'JetBrains Mono',monospace",fontWeight:500}}>{b.pct.toFixed(1)}%</div>
                        </div>
                        <div className="pb" style={{height:7}}><div className="pf" style={{width:b.pct+"%",background:b.g,boxShadow:"0 0 8px "+b.tc+"66"}}/></div>
                        <div style={{fontSize:11,color:"var(--text-3)",marginTop:10,fontWeight:500}}>{b.sub}</div>
                      </div>
                    ))}
                  </div>
                  <div className="glass" style={{padding:"22px 24px",marginBottom:18}}>
                    <div className="stat-glow"/>
                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18,flexWrap:"wrap",gap:10}}>
                      <div style={{fontSize:15,fontWeight:700}}>{mkLabel(activeMonth)}</div>
                      {monthPicker}
                    </div>
                    {CATEGORIES.map(cat=>{
                      const spent=spentByCat[cat]||0,budget=MONTHLY_BUDGET[cat],pct=Math.min((spent/budget)*100,100),over=spent>budget;
                      return (
                        <div key={cat} style={{marginBottom:16}}>
                          <div style={{display:"flex",justifyContent:"space-between",marginBottom:7,alignItems:"center"}}>
                            <div style={{display:"flex",alignItems:"center",gap:9}}>
                              <div className="dot" style={{background:COLORS[cat],boxShadow:"0 0 7px "+GLOWS[cat]}}/>
                              <span style={{fontSize:13,fontWeight:600,color:"var(--text-2)"}}>{cat}</span>
                            </div>
                            <div style={{fontSize:12,fontFamily:"'JetBrains Mono',monospace",fontWeight:500}}>
                              <span style={{color:over?"#ff6b8a":"var(--text)"}}>{fmt(spent)}</span>
                              <span style={{color:"var(--text-3)"}}> / {fmt(budget)}</span>
                              {over && <span style={{color:"#ff6b8a",marginLeft:8,fontSize:10,fontWeight:700,background:"rgba(255,80,100,.12)",padding:"2px 6px",borderRadius:4}}>+{fmt(spent-budget)}</span>}
                            </div>
                          </div>
                          <div className="pb"><div className="pf" style={{width:pct+"%",background:over?"linear-gradient(90deg,#ff4060,#ff6b8a)":COLORS[cat],boxShadow:over?"0 0 6px rgba(255,80,100,.4)":"0 0 6px "+GLOWS[cat]}}/></div>
                        </div>
                      );
                    })}
                  </div>
                  <div className="glass" style={{padding:"22px 24px"}}>
                    <div className="stat-glow"/>
                    <div style={{fontSize:13,fontWeight:700,marginBottom:16,color:"var(--text-2)"}}>Quick Add Expense</div>
                    {expenseForm}
                  </div>
                </div>
              )}

              {tab==="expenses" && (
                <div>
                  <div className="glass" style={{padding:"22px 24px",marginBottom:16}}>
                    <div className="stat-glow"/>
                    <div style={{fontSize:13,fontWeight:700,marginBottom:16,color:"var(--text-2)"}}>Log Expense</div>
                    {expenseForm}
                  </div>
                  <div className="glass" style={{padding:"22px 24px"}}>
                    <div className="stat-glow"/>
                    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,flexWrap:"wrap",gap:10}}>
                      <div style={{fontSize:15,fontWeight:700}}>{mkLabel(activeMonth)}<span style={{fontSize:12,color:"var(--text-3)",marginLeft:8,fontWeight:500}}>({monthExpenses.length} entries)</span></div>
                      {monthPicker}
                    </div>
                    {monthExpenses.length===0
                      ? <div style={{textAlign:"center",color:"var(--text-3)",padding:"48px 0",fontSize:13}}>No expenses for {mkLabel(activeMonth)}</div>
                      : [...monthExpenses].sort((a,b)=>b.date.localeCompare(a.date)).map(e=>(
                        <div key={e.id} className="row">
                          <div className="dot" style={{background:COLORS[e.category],boxShadow:"0 0 7px "+GLOWS[e.category]}}/>
                          <div style={{flex:1}}>
                            <div style={{fontSize:13,fontWeight:600}}>{e.category}{e.note?<span style={{color:"var(--text-3)",fontWeight:400}}> · {e.note}</span>:""}</div>
                            <div style={{fontSize:11,color:"var(--text-3)",marginTop:2}}>{e.date}</div>
                          </div>
                          <div style={{fontFamily:"'JetBrains Mono',monospace",fontSize:14,fontWeight:500}}>{fmt(e.amount)}</div>
                          <button className="btn-ghost" onClick={()=>setExpenses(p=>p.filter(x=>x.id!==e.id))}>&#215;</button>
                        </div>
                      ))
                    }
                    {monthExpenses.length>0 && (
                      <div style={{display:"flex",justifyContent:"space-between",paddingTop:14,marginTop:6,borderTop:"1px solid rgba(255,255,255,.07)"}}>
                        <span style={{fontSize:13,color:"var(--text-3)",fontWeight:600}}>Month Total</span>
                        <span style={{fontFamily:"'JetBrains Mono',monospace",fontSize:15,fontWeight:600,color:totalSpent>TOTAL_BUDGET?"#ff6b8a":"var(--text)"}}>{fmt(totalSpent)}</span>
                      </div>
                    )}
                  </div>
                </div>
              )}

              {tab==="savings" && (
                <div>
                  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginBottom:18}}>
                    <div className="glass" style={{padding:"22px 24px"}}>
                      <div className="stat-glow"/>
                      <div className="sl">Total Saved</div>
                      <div className="sv" style={{color:"#c084fc",marginBottom:14}}>{fmt(totalSaved)}</div>
                      <div className="pb" style={{height:8}}><div className="pf" style={{width:savingsPct+"%",background:"linear-gradient(90deg,#9333ea,#c084fc)",boxShadow:"0 0 10px rgba(160,80,255,.4)"}}/></div>
                      <div style={{display:"flex",justifyContent:"space-between",marginTop:8}}>
                        <span style={{fontSize:11,color:"var(--text-3)",fontWeight:600}}>{savingsPct.toFixed(1)}% done</span>
                        <span style={{fontSize:11,color:"var(--text-3)",fontWeight:600}}>{fmt(SAVINGS_TARGET-totalSaved)} left</span>
                      </div>
                    </div>
                    <div className="glass" style={{padding:"22px 24px"}}>
                      <div className="stat-glow"/>
                      <div className="sl">Projected by Feb 2027</div>
                      {savings.length>1?(()=>{
                        const tots=savings.reduce((acc,s)=>{const m=s.date.slice(0,7);acc[m]=(acc[m]||0)+s.amount;return acc;},{});
                        const avg=Object.values(tots).reduce((a,b)=>a+b,0)/Object.keys(tots).length;
                        const left=Math.max(0,(new Date("2027-02-01")-new Date())/(1000*60*60*24*30));
                        const proj=totalSaved+avg*left;
                        return <div><div className="sv" style={{color:proj>=SAVINGS_TARGET?"#34eba8":"#ffb347",marginBottom:6}}>{fmt(proj)}</div><div style={{fontSize:11,color:"var(--text-3)",fontWeight:600}}>Avg {fmt(avg)}/mo · {left.toFixed(0)} months left</div></div>;
                      })():<div style={{color:"var(--text-3)",fontSize:13,paddingTop:10}}>Log savings across 2+ months to project</div>}
                    </div>
                  </div>
                  <div className="glass" style={{padding:"22px 24px"}}>
                    <div className="stat-glow"/>
                    <div style={{fontSize:15,fontWeight:700,marginBottom:16}}>Savings Log</div>
                    {savings.length===0
                      ? <div style={{textAlign:"center",color:"var(--text-3)",padding:"48px 0",fontSize:13}}>No savings yet — hit "+ Savings" above</div>
                      : [...savings].sort((a,b)=>b.date.localeCompare(a.date)).map(s=>(
                        <div key={s.id} className="row">
                          <div className="dot" style={{background:"#c084fc",boxShadow:"0 0 7px rgba(192,132,252,.4)"}}/>
                          <div style={{flex:1}}>
                            <div style={{fontSize:13,fontWeight:600}}>Savings{s.note?<span style={{color:"var(--text-3)",fontWeight:400}}> · {s.note}</span>:""}</div>
                            <div style={{fontSize:11,color:"var(--text-3)",marginTop:2}}>{s.date}</div>
                          </div>
                          <div style={{fontFamily:"'JetBrains Mono',monospace",fontSize:14,fontWeight:600,color:"#c084fc"}}>+{fmt(s.amount)}</div>
                          <button className="btn-ghost" onClick={()=>setSavings(p=>p.filter(x=>x.id!==s.id))}>&#215;</button>
                        </div>
                      ))
                    }
                  </div>
                </div>
              )}
            </div>

            {showStatement && (
              <div className="ov" onClick={()=>{ if(parseStage!=="parsing") setShowStatement(false); }}>
                <div className="mod mod-wide" onClick={e=>e.stopPropagation()} style={{maxHeight:"85vh",overflowY:"auto"}}>
                  {parseStage==="upload" && (
                    <div>
                      <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24}}>
                        <div><GradTitle size={20}>Import Bank Statement</GradTitle><div style={{fontSize:13,color:"var(--text-2)",marginTop:6}}>Upload a PDF or screenshot — AI extracts all expenses</div></div>
                        <button className="btn-ghost" onClick={()=>setShowStatement(false)} style={{fontSize:18,padding:"4px 10px"}}>&#215;</button>
                      </div>
                      {parseError && <div style={{background:"rgba(255,80,100,.1)",border:"1px solid rgba(255,80,100,.3)",borderRadius:12,padding:"12px 16px",marginBottom:20,fontSize:13,color:"#ff8080"}}>{parseError}</div>}
                      <div className={"upload-zone"+(dragOver?" drag":"")} onDragOver={e=>{e.preventDefault();setDragOver(true)}} onDragLeave={()=>setDragOver(false)} onDrop={e=>{e.preventDefault();setDragOver(false);const f=e.dataTransfer&&e.dataTransfer.files[0];if(f)handleStatementFile(f);}}>
                        <input ref={stmtRef} type="file" accept=".pdf,image/*" onChange={e=>{const f=e.target.files[0];if(f)handleStatementFile(f);e.target.value="";}}/>
                        <div style={{fontSize:36,marginBottom:14}}>&#127974;</div>
                        <div style={{fontSize:15,fontWeight:700,marginBottom:8}}>Drop your statement here</div>
                        <div style={{fontSize:13,color:"var(--text-3)",marginBottom:20}}>PDF or image — Chase, Citi, BofA, Wells Fargo & more</div>
                        <button className="btn-accent" onClick={()=>stmtRef.current.click()}>Choose File</button>
                      </div>
                    </div>
                  )}
                  {parseStage==="parsing" && (
                    <div style={{textAlign:"center",padding:"48px 0"}}>
                      <div className="spin"/>
                      <GradTitle size={18}>Reading your statement...</GradTitle>
                      <div style={{fontSize:13,color:"var(--text-3)",marginTop:10}}>AI is extracting and categorizing your expenses</div>
                    </div>
                  )}
                  {parseStage==="review" && (
                    <div>
                      <div style={{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:20,flexWrap:"wrap",gap:10}}>
                        <div><GradTitle size={20}>Review Expenses</GradTitle><div style={{fontSize:13,color:"var(--text-2)",marginTop:6}}><strong style={{color:"var(--text)"}}>{parsedItems.length}</strong> found &nbsp;·&nbsp; <strong style={{color:"#c084fc"}}>{inclCount} selected</strong> &nbsp;·&nbsp; <strong style={{color:"#34eba8"}}>{fmt(inclTotal)}</strong></div></div>
                        <div style={{display:"flex",gap:8}}>
                          <button className="btn-glass" style={{fontSize:11}} onClick={()=>setParsedItems(p=>p.map(i=>({...i,include:true})))}>All</button>
                          <button className="btn-glass" style={{fontSize:11}} onClick={()=>setParsedItems(p=>p.map(i=>({...i,include:false})))}>None</button>
                          <button className="btn-ghost" onClick={()=>setShowStatement(false)} style={{fontSize:18,padding:"4px 10px"}}>&#215;</button>
                        </div>
                      </div>
                      <ReviewTable items={parsedItems} onToggle={toggleItem} onCat={changeCat}/>
                      <div style={{display:"flex",gap:10,marginTop:20,paddingTop:16,borderTop:"1px solid rgba(255,255,255,.07)"}}>
                        <button className="btn-green" style={{flex:1,padding:"13px"}} onClick={commitParsed} disabled={inclCount===0}>Import {inclCount} Expense{inclCount!==1?"s":""} ({fmt(inclTotal)})</button>
                        <button onClick={()=>{setParseStage("upload");setParsedItems([]);}} style={{padding:"13px 20px",background:"rgba(255,255,255,.06)",border:"1px solid rgba(255,255,255,.12)",color:"var(--text-2)",borderRadius:12,cursor:"pointer",fontSize:13,fontWeight:600}}>Re-upload</button>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}

            {showSavings && (
              <div className="ov" onClick={()=>setShowSavings(false)}>
                <div className="mod" onClick={e=>e.stopPropagation()}>
                  <GradTitle size={20}>Log Savings</GradTitle>
                  <div style={{marginBottom:16,marginTop:24}}><div className="lbl">Date</div><input className="ifield" type="date" value={sDate} onChange={e=>setSDate(e.target.value)}/></div>
                  <div style={{marginBottom:16}}><div className="lbl">Amount ($)</div><input className="ifield" type="number" min="0" step="0.01" placeholder="e.g. 7500" value={sAmt} onChange={e=>setSAmt(e.target.value)} autoFocus={true}/></div>
                  <div style={{marginBottom:24}}><div className="lbl">Note (optional)</div><input className="ifield" type="text" placeholder="Jan paycheck, bonus..." value={sNote} onChange={e=>setSNote(e.target.value)}/></div>
                  <div style={{display:"flex",gap:10}}>
                    <button className="btn-accent" style={{flex:1,padding:"12px"}} onClick={addSavings}>Save</button>
                    <button onClick={()=>setShowSavings(false)} style={{flex:1,padding:"12px",background:"rgba(255,255,255,.06)",border:"1px solid rgba(255,255,255,.12)",color:"var(--text-2)",borderRadius:12,cursor:"pointer",fontSize:13,fontWeight:600}}>Cancel</button>
                  </div>
                </div>
              </div>
            )}

            {showImport && (
              <div className="ov" onClick={()=>setShowImport(false)}>
                <div className="mod" onClick={e=>e.stopPropagation()}>
                  <GradTitle size={20}>Load Saved Data?</GradTitle>
                  <div style={{fontSize:13,color:"var(--text-2)",margin:"16px 0 20px",lineHeight:1.6}}>This replaces your current session with data from the file you selected.</div>
                  {importError && <div style={{color:"#ff6b8a",fontSize:12,marginBottom:14,fontWeight:600}}>{importError}</div>}
                  <div style={{display:"flex",gap:10}}>
                    <button className="btn-accent" style={{flex:1,padding:"12px"}} onClick={doImport}>Yes, Load It</button>
                    <button onClick={()=>setShowImport(false)} style={{flex:1,padding:"12px",background:"rgba(255,255,255,.06)",border:"1px solid rgba(255,255,255,.12)",color:"var(--text-2)",borderRadius:12,cursor:"pointer",fontSize:13,fontWeight:600}}>Cancel</button>
                  </div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
  </script>
</body>
</html>